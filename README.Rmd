---
output: github_document
---

<!-- README.md is generated from README.Rmd. Please edit that file -->

```{r, include = FALSE}
knitr::opts_chunk$set(
  collapse = TRUE,
  comment = "#>",
  fig.path = "man/figures/README-",
  out.width = "100%"
)
```

# ReportMaster

<!-- badges: start -->
<!-- badges: end -->

The ReportMaster package is designed to create dynamic survey reports automatically. The package retrieves data from Lime Survey, combines it with meta data to create dynamic reports and runs only for surveys that are expired.

## Installation

You can install the development version of ReportMaster from [GitHub](https://github.com/) with:

``` r
# install.packages("pak")
pak::pak("edgar-treischl/ReportMaster")
```

## ReportMaster in Action

The `run_CronJob()` function is the main function of the package. It checks for expired surveys and creates reports for them.

```{r, eval=FALSE}
library(ReportMaster)
run_CronJob()
# Lucky fellow, there are new expired surveys!
# Joining with `by = join_by(sid)`
# Joining with `by = join_by(sid)`
# ℹ Get parameters for: Adalbert-Raps-Schule Staatliche Berufsoberschule Kulmbach
# Joining with `by = join_by(sid)`
# Joining with `by = join_by(sid)`
# Joining with `by = join_by(sid)`
# Joining with `by = join_by(sid, vars)`
# ✔ Downloaded data from LimeSurvey.
# ✔ All parameters set.   
# ✔ Create data and plots [3.3s]
# ✔ Get report infos [881ms]
# ✔ Create plots [2.1s]────────────────────────────────────────────────────── 100%
# ✔ Create tables [4.4s]───────────────────────────────────────────────────── 100%
# ✔ Exported PDF file for school '0850' and group 'elt'
```




## To Be Done

Anpassung der Daten für die Filterfragen. Bislang werfen wir alles weg, was "k. A." ist.

```{r, eval=FALSE}
data <- data |> dplyr::filter(vals != "k. A.")
```

Dokumentation des Automatisierungssystems. Beispiel: In Zukunft wird ein neues Template geben, wie greift eine Veränderung der Templates in den Code ein?

```{r, eval=FALSE}
surveystring <- "0001_202425_ubb_allg_gy_eva_00_2022_p1"
```
- SNR: Identifikation aller Umfragen via ersten vier Zeichen: 0001
- UBB: Identifikation der UBB/Umfrage via String `_ubb_`
- Schulart: Identifikation der Schulart via String `_gy_`, `_rs_`, etc.
- Ganztag: Identifikation der Ganztagsschule via String `_p2` (`p3` und `p4` werden im Vorfeld auf `p1` bzw. `p2` zurück gesetzt)


